version: 2
models:
  - name: _live
    columns:
      - name: udf_rest_api_args_only
        tests:
          - test_udf:
              name: test___live_udf_rest_api_args_only
              args: >
                'GET',
                'https://api.example.com',
                {'Content-Type': 'application/json'},
                {'hello': 'world'},
                'my_secret'
              assertions:
                - |
                  result = {
                    'method': 'GET',
                    'url': 'https://api.example.com',
                    'headers': {'Content-Type': 'application/json'},
                    'data': {'hello': 'world'},
                    'secret_name': 'my_secret'
                  }
          - test_udf:
              name: test___live_udf_rest_api_args_only_null
              args: null, null, null, null, null
              assertions:
                - result = {}
          - test_udf:
              name: test___live_udf_api
              args: >
                'GET',
                'https://api.example.com',
                {'Content-Type': 'application/json'},
                {'hello': 'world'},
                'non_streamline_user'
                'my_secret'
              assertions:
                - |
                  result = {
                    'method': 'GET',
                    'url': 'https://httpbin.org/get',
                    'headers': {'Content-Type': 'application/json'},
                    'data': {'hello': 'world'},
                    'user': 'non_streamline_user',
                    'secret_name': 'my_secret'
                  }
